---
/* TODO:
- [ ] Mobile Landscape: /projekte wierd height behaviour vgl. Handy nicht chromium!!!


NICE-TO-HAVE:
- [ ] Fallback when JS is disabled!
- [ ] custom Layouts & export to DIN A3 etc...

*/
import Layout from '../../layouts/Layout.astro';
import { CollectionEntry, getCollection } from 'astro:content'; 
import { Image, Picture } from '@astrojs/image/components';
import BasicScripts from '../../components/basicScripts.astro';
import Slideshow from '../../components/Slideshow';
import Modal from '../../components/Modal';


export async function getStaticPaths() {
  const allProjects = await getCollection('projects');
  return allProjects.map((proj) => ({
  params: { project: proj.slug , cat: proj.data.category },
    props: proj,
  }));
}

type Props = CollectionEntry<'projects'>;
const proj = Astro.props;
// console.log(proj);
const p = proj.data;

// Pictures Aspect Ratio
const width = 3;
const height = 2;

const slideshow_pictures = [p.titleimg.img].concat(p.fotos.map((img) => img.foto));

const slideshow_pictures_alts = [p.titleimg.alt].concat(p.fotos.map((img) => img.alt));

/* 
const slideshow_plans = [];
const slideshow_plans_alts = []; 
*/

let slideshow_images = slideshow_pictures // or slideshow_plans
let slideshow_alts = slideshow_pictures_alts // or slideshow_plans_alts

console.log(slideshow_images);
console.log(slideshow_alts);
---
<BasicScripts />
<script>
</script>

  <Layout title={`AE30 - ${p.title} - work in progress`} description= {`${p.category}/${p.title}`}image="">

  <section class="project_presentation" aria-label={`Projekt ${p.title} Presentation`}>
    <article class="project">

      <Slideshow images={slideshow_images} titles={slideshow_alts} client:load>
      </Slideshow>
      
      
      <Modal client:load >
      <span slot="proj_title">{p.title}</span>
      <!-- optionale Werte condition abfrage notw? -->
      
      <!-- 
      <ul slot="kennwerte">
      <p>
      {p.category}
      {p.subcategory} 
      {p.category}
      

      </p>
        <li>{p.char.typ}</li>
        <li>{p.char.nfl}</li>
        <li>{p.char.ri}</li>
        <li>{p.char.kosten}</li>
      </ul>
      -->
 

      </Modal>

    </article>

    <section class="footer_controls" aria-label="Plankopf Footer Controls">
      <span class="cat">{p.category} - </span>
      <span class="title">{p.title}</span>
      <button class="" name="Toggle Text">Text Toggle</button>
      <span class="page_counter">1/4</span>
      <button class="" name="Toggle Plans">Plans Toggle</button>
    </section>

  </section>
  </Layout>

  <!--+++++++++++++++++++++++++++ -->

<style is:global>
  .wrapper{
    margin: 0 !important;
    /* background: lightblue !important; */
  }
  .slideshow_div{}
</style>

<style>

  article.project{
    background: green;
  }
.project_presentation{
  /* background: green; */
  min-height: 100vh;

  display: flex;
  align-items: center; /* center vertically flexbox */
  justify-content: center; /* center horizontally flex */

  overflow: hidden;
}
article.project{ 
  /* background: lightblue;  */
}

article .pictures{}
article .plans{}
article .texts{}
/* FOOTER CONTROLS  ----------------------------*/
  .footer_controls{
    /* display: none; */
    font-family: var(--fsans2);
    position: fixed;
    bottom: 0;

    width: 100%;
    height: calc(var(--gmodulem)*3);
    background: grey;
    /* opacity: .5; */
    text-align: center;
  }
  .footer_controls button{
    height: 100%;
  }
  .footer_controls > {
    backdrop-filter: blur(2px);
  }

</style>
